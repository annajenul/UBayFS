<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="UBayFS">
<title>A quick tour through UBayFS • UBayFS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A quick tour through UBayFS">
<meta property="og:description" content="UBayFS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">UBayFS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/UBayFS.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BFS_UBayFS.html">Block feature selection with UBayFS</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A quick tour through UBayFS</h1>
                        <h4 data-toc-skip class="author">Anna Jenul,
Stefan Schrunner</h4>
            
            <h4 data-toc-skip class="date">2022-12-14</h4>
      
      
      <div class="d-none name"><code>UBayFS.Rmd</code></div>
    </div>

    
    
<style>
  body {
  text-align: justify;
  padding: 1em}
  header:after {
    content: "";
    position: absolute;
    top: 55px;
    right: 40px;
    width: 120px;
    height: 120px;
    background-image:url("logo.png");
    background-size:120px;
  }
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The UBayFS package implements the framework proposed in <span class="citation">(Jenul et al. 2022)</span>, together with an
interactive Shiny dashboard, which makes UBayFS applicable to R-users
with different levels of expertise. UBayFS is an ensemble feature
selection technique embedded in a Bayesian statistical framework. The
method combines data and user knowledge, where the first is extracted
via data-driven ensemble feature selection. The user can control the
feature selection by assigning prior weights to features and penalizing
specific feature combinations. In particular, the user can define a
maximum number of selected features and must-link constraints (features
must be selected together) or cannot-link constraints (features must not
be selected together). A parameter <span class="math inline">\(\rho\)</span> regulates the shape of a penalty
term accounting for side constraints, where feature sets that violate
constraints lead to a lower target value.</p>
<p>In this vignette, we use the Breast Cancer Wisconsin dataset <span class="citation">(Wolberg and Mangasarian 1990)</span> for
demonstration. Specifically, the dataset consists of 569 samples and 30
features and can be downloaded as a demo dataset by calling
<code>data(bcw)</code>. The dataset describes a classification problem,
where the aim is to distinguish between malignant and benign cancer
based on image data. Features are derived from 10 image characteristics,
where each characteristic is represented by three features (summary
statistics) in the dataset. For instance, the characteristic
<em>radius</em> is represented by features <em>radius mean</em>,
<em>radius standard deviation</em>, and <em>radius worst</em>.</p>
<p>UBayFS is implemented via a core S3-class <code>UBaymodel</code>,
along with help functions. An overview of the ‘UBaymodel’ class and its
main generic functions is shown in the following diagram:</p>
<p><img src="UBay_UML.png" width="70%" height="70%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="requirements-and-dependencies">Requirements and dependencies<a class="anchor" aria-label="anchor" href="#requirements-and-dependencies"></a>
</h3>
<ul>
<li>R (&gt;= 3.5.0)</li>
<li>GA</li>
<li>matrixStats</li>
<li>shiny</li>
<li>mRMRe</li>
<li>Rdimtools</li>
<li>DirichletReg</li>
<li>ggplot2</li>
<li>gridExtra</li>
<li>utils</li>
<li>hyper2</li>
<li>methods</li>
<li>prettydoc</li>
</ul>
<p>In addition, some functionality of the package (in particular, the
interactive Shiny interface) requires the following dependencies:</p>
<ul>
<li>shinyWidgets</li>
<li>shinyalert</li>
<li>DT</li>
<li>RColorBrewer</li>
<li>tcltk</li>
<li>shinyjs</li>
<li>shinythemes</li>
<li>shinyBS</li>
<li>testthat (&gt;= 3.0.0)</li>
<li>rmarkdown</li>
<li>dplyr</li>
<li>plyr</li>
<li>knitr</li>
</ul>
<p>Like other R packages, UBayFS is loaded using the
<code><a href="https://annajenul.github.io/UBayFS/">library(UBayFS)</a></code> command. The sample dataset is accessed via
<code>data(bcw)</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://annajenul.github.io/UBayFS/">UBayFS</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span></span>
<span><span class="co">#&gt; Warning: 'rgl.init' failed, running with 'rgl.useNULL = TRUE'.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bcw</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This section summarizes the core parts of UBayFS, where a central
part is Bayes’ Theorem for two random variables <span class="math inline">\(\boldsymbol{\theta}\)</span> and <span class="math inline">\(\boldsymbol{y}\)</span>: <span class="math display">\[p(\boldsymbol{\theta}|\boldsymbol{y})\propto
p(\boldsymbol{y}|\boldsymbol{\theta})\cdot
p(\boldsymbol{\theta}),\]</span> where <span class="math inline">\(\boldsymbol{\theta}\)</span> represents an
importance parameter of single features and <span class="math inline">\(\boldsymbol{y}\)</span> collects evidence about
<span class="math inline">\(\boldsymbol{\theta}\)</span> from an
ensemble of elementary feature selectors. In the following, the concept
will be outlined.</p>
<div class="section level3">
<h3 id="ensemble-feature-selection-as-likelihood">Ensemble feature selection as likelihood<a class="anchor" aria-label="anchor" href="#ensemble-feature-selection-as-likelihood"></a>
</h3>
<p>The first step in UBayFS is to build <span class="math inline">\(M\)</span> ensembles of elementary feature
selectors. Each elementary feature selector <span class="math inline">\(m=1,\dots,M\)</span> selects features, denoted by
a binary membership vector <span class="math inline">\(\boldsymbol{\delta}^{(m)} \in \{0,1\}^N\)</span>,
based on a randomly selected training dataset, where <span class="math inline">\(N\)</span> denotes the total number of features in
the dataset. In the binary membership vector <span class="math inline">\(\boldsymbol{\delta}^{(m)}\)</span>, a component
<span class="math inline">\(\delta_i^{(m)}=1\)</span> indicates that
feature <span class="math inline">\(i\in\{1,\dots,N\}\)</span> is
selected, and <span class="math inline">\(\delta_i^{(m)}=0\)</span>
otherwise. Statistically, we interpret the result from each elementary
feature selector as a realization from a multinomial distribution with
parameters <span class="math inline">\(\boldsymbol{\theta}\)</span> and
<span class="math inline">\(l\)</span>, where <span class="math inline">\(\boldsymbol{\theta}\in[0,1]^N\)</span> defines the
success probabilities of sampling each feature in an individual feature
selection and <span class="math inline">\(l\)</span> corresponds to the
number of features selected in <span class="math inline">\(\boldsymbol{\delta}^{(m)}\)</span>. Therefore, the
joint probability density of the observed data <span class="math inline">\(\boldsymbol{y} =
\sum\limits_{m=1}^{M}\boldsymbol{\delta}^{(m)}\in\{0,\dots,M\}^N\)</span>
— the likelihood function — has the form <span class="math display">\[
p(\boldsymbol{y}|\boldsymbol{\theta}) = \prod\limits_{m=1}^{M}
f_{\text{mult}}(\boldsymbol{\delta}^{(m)};\boldsymbol{\theta},l),\]</span>
where <span class="math inline">\(f_{\text{mult}}\)</span> is the
probability density function of the multinomial distribution.</p>
</div>
<div class="section level3">
<h3 id="expert-knowledge-as-prior">Expert knowledge as prior<a class="anchor" aria-label="anchor" href="#expert-knowledge-as-prior"></a>
</h3>
<p>UBayFS includes two types of expert knowledge: prior feature weights
and feature set constraints.</p>
<div class="section level4">
<h4 id="prior-feature-weights">Prior feature weights<a class="anchor" aria-label="anchor" href="#prior-feature-weights"></a>
</h4>
<p>To introduce expert knowledge about the importance of features, the
user may define a vector <span class="math inline">\(\boldsymbol{\alpha}
= (\alpha_1,\dots,\alpha_N)\)</span>, <span class="math inline">\(\alpha_i&gt;0\)</span> for all <span class="math inline">\(i=1,\dots,N\)</span>, assigning a weight to each
feature. High weights indicate that a feature is important. By default,
if all features are equally important or no prior weighting is used,
<span class="math inline">\(\boldsymbol{\alpha}\)</span> is set to the
1-vector of length <span class="math inline">\(N\)</span>. With the
weighting in place, we assume the a-priori feature importance parameter
<span class="math inline">\(\boldsymbol{\theta}\)</span> follows a
Dirichlet distribution <span class="citation">(Maier 2020)</span> <span class="math display">\[p(\boldsymbol{\theta}) =
f_{\text{Dir}}(\boldsymbol{\theta};\boldsymbol{\alpha}),\]</span> where
the probability density function of the Dirichlet distribution is given
as <span class="math display">\[f_{\text{Dir}}(\boldsymbol{\theta};\boldsymbol{\alpha})
= \frac{1}{\text{B}(\boldsymbol{\alpha})} \prod\limits_{n=1}^N
\theta_n^{\alpha_n-1},\]</span> where <span class="math inline">\(\text{B}(.)\)</span> denotes the multivariate Beta
function. Generalizations of the Dirichlet distribution <span class="citation">Hankin (2010)</span> are also implemented in
UBayFS.</p>
<p>Since the Dirichlet distribution is the conjugate prior with respect
to a multivariate likelihood, the posterior density is given as <span class="math display">\[p(\boldsymbol{\theta}|\boldsymbol{y}) \propto
f_{\text{Dir}}(\boldsymbol{\theta};\boldsymbol{\alpha}^\circ),\]</span>
with <span class="math display">\[\boldsymbol{\alpha}^\circ = \left(
\alpha_1 + \sum\limits_{m=1}^M \delta_1^{(m)}, \dots, \alpha_N +
\sum\limits_{m=1}^M \delta_N^{(m)}  \right)\]</span> representing the
posterior parameter vector <span class="math inline">\(\boldsymbol{\alpha}^\circ\)</span>.</p>
</div>
<div class="section level4">
<h4 id="feature-set-constraints">Feature set constraints<a class="anchor" aria-label="anchor" href="#feature-set-constraints"></a>
</h4>
<p>In addition to the prior weighting of features, the UBayFS user can
also add different types of constraints to the feature selection:</p>
<ul>
<li>
<em>max-size constraint</em>: Maximum number of features that shall
be selected.</li>
<li>
<em>must-link constraint</em>: For a pair of features, either both
or none is selected (defined as pairwise constraints, one for each pair
of features).</li>
<li>
<em>cannot-link constraint</em>: Used if a pair of features must not
be selected jointly.</li>
</ul>
<p>All constraints can be defined <em>block-wise</em> between feature
blocks (instead of individual features). Constraints are represented as
a linear system of linear inequalities <span class="math inline">\(\boldsymbol{A}\boldsymbol{\delta}-\boldsymbol{b}\leq
\boldsymbol{0}\)</span>, where <span class="math inline">\(\boldsymbol{A}\in\mathbb{R}^{K\times N}\)</span>
and <span class="math inline">\(\boldsymbol{b}\in\mathbb{R}^K\)</span>.
<span class="math inline">\(K\)</span> denotes the total number of
constraints. For constraint <span class="math inline">\(k \in
1,..,K\)</span>, a feature set <span class="math inline">\(\boldsymbol{\delta}\)</span> is admissible only if
<span class="math inline">\(\left(\boldsymbol{a}^{(k)}\right)^T\boldsymbol{\delta}
- b^{(k)} \leq 0\)</span>, leading to the inadmissibility function
(penalty term)</p>
<p><span class="math display">\[\begin{align}
\kappa_{k,\rho}(\boldsymbol{\delta}) = \left\{
    \begin{array}{l l}
    0 &amp;
\text{if}~\left(\boldsymbol{a}^{(k)}\right)^T\boldsymbol{\delta}\leq
b^{(k)}\\
    1 &amp; \text{if}~
\left(\boldsymbol{a}^{(k)}\right)^T\boldsymbol{\delta}&gt; b^{(k)} \land
\rho =\infty\\
    \frac{1-\xi_{k,\rho}}{1 + \xi_{k,\rho}} &amp; \text{otherwise},
    \end{array}
    \right.
\end{align}\]</span></p>
<p>where <span class="math inline">\(\rho\in\mathbb{R}^+ \cup
\{\infty\}\)</span> denotes a relaxation parameter and <span class="math inline">\(\xi_{k,\rho} = \exp\left(-\rho \left(\left(
\boldsymbol{a}^{(k)}\right)^T\boldsymbol{\delta} -
b^{(k)}\right)\right)\)</span> defines the exponential term of a
logistic function. To handle <span class="math inline">\(K\)</span>
different constraints for one feature selection problem, the joint
inadmissibility function is given as <span class="math display">\[
\kappa(\boldsymbol{\delta})
    = 1 - \prod\limits_{k=1}^{K} \left(1
-\kappa_{k,\rho}(\boldsymbol{\delta})\right)\]</span> which originates
from the idea that <span class="math inline">\(\kappa = 1\)</span>
(maximum penalization) if at least one <span class="math inline">\(\kappa_{k,\rho}=1\)</span>, while <span class="math inline">\(\kappa=0\)</span> (no penalization) if all <span class="math inline">\(\kappa_{k,\rho}=0\)</span>.</p>
<p>To obtain an optimal feature set <span class="math inline">\(\boldsymbol{\delta}^\star\)</span>, we use a
target function <span class="math inline">\(U(\boldsymbol{\delta},
\boldsymbol{\theta})\)</span> which represents a posterior expected
utility of feature sets <span class="math inline">\(\boldsymbol{\delta}\)</span> given the posterior
feature importance parameter <span class="math inline">\(\boldsymbol{\theta}\)</span>, regularized by the
inadmissibility function <span class="math inline">\(\kappa(.)\)</span>.</p>
<p><span class="math display">\[\mathbb{E}_{\boldsymbol{\theta}|\boldsymbol{y}}[U(\boldsymbol{\delta},
\boldsymbol{\theta}(\boldsymbol{y}))] = \boldsymbol{\delta}^T
\mathbb{E}_{\boldsymbol{\boldsymbol{\delta}}|\boldsymbol{y}}[\boldsymbol{\theta}(\boldsymbol{y})]-\lambda\kappa(\boldsymbol{\delta})\longrightarrow
\underset{\boldsymbol{\delta}\in\{0,1\}^N}{\text{arg max}}
\]</span></p>
<p>Since an exact optimization is impossible due to the non-linear
function <span class="math inline">\(\kappa\)</span>, we use a genetic
algorithm to find an appropriate feature set. In detail, the genetic
algorithm is initialized via a Greedy algorithm and computes
combinations of the given feature sets with regard to a fitness function
in each iteration.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="application-of-ubayfs">Application of UBayFS<a class="anchor" aria-label="anchor" href="#application-of-ubayfs"></a>
</h2>
<div class="section level3">
<h3 id="ensemble-training">Ensemble Training<a class="anchor" aria-label="anchor" href="#ensemble-training"></a>
</h3>
<p>The function <code><a href="../reference/build.UBaymodel.html">build.UBaymodel()</a></code> initializes the UBayFS
model and trains an ensemble of elementary feature selectors. The
training dataset and target are initialized with the arguments
<code>data</code> and <code>target</code>. Although the UBayFS concept
permits unsupervised, multiclass, or regression setups, the current
implementation supports binary target variables only. While
<code>M</code> defines the ensemble size (number of elementary feature
selectors), the types of the elementary feature selectors is set via
<code>method</code>. Three different feature selectors (mRMR, Fisher
schore and Laplace score) are implemented as baseline. In general, the
<code>method</code> argument allows for each self-implemented feature
selection function with the arguments <code>X</code> (describes the
data), <code>y</code> (describes the target), <code>n</code> (describes
the number of features that shall be selected), and <code>name</code>
(name of the method). The function must return the indices of the
selected features and the input name. An example with classification
trees is shown below. Each ensemble model is trained on a random subset
comprising <code>tt_split</code><span class="math inline">\(\cdot
100\)</span> percent of the train data. The help function
<code><a href="../reference/buildConstraints.html">buildConstraints()</a></code> provides an easy way to define side
constraints for the model. Using the argument <code>prior_model</code>
the user specifies whether the standard Dirichlet distribution or a
generalized variant should be used as prior model. Furthermore, the
number of features selected in each ensemble can be controlled by the
parameter <code>nr_features</code>.</p>
<p>For the standard UBayFS initialization, all prior feature weights are
set to 1, and no feature constraints are included yet. The
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function provides an overview of the dataset, the
prior weights, and the likelihood — ensemble counts indicate how often a
feature was selected over the ensemble feature selections.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/build.UBaymodel.html">build.UBaymodel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bcw</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                        target <span class="op">=</span> <span class="va">bcw</span><span class="op">$</span><span class="va">labels</span>,</span>
<span>                        M <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                        tt_split <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                        nr_features <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"mRMR"</span>,</span>
<span>                        prior_model <span class="op">=</span><span class="st">"dirichlet"</span>,</span>
<span>                        weights <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                        lambda <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        constraints <span class="op">=</span> <span class="fu"><a href="../reference/buildConstraints.html">buildConstraints</a></span><span class="op">(</span>constraint_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max_size"</span><span class="op">)</span>, </span>
<span>                                                       constraint_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>                                                       num_elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bcw</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                                                       rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        optim_method <span class="op">=</span> <span class="st">"GA"</span>,</span>
<span>                        popsize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                        maxiter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                        shiny <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                        <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt;  UBayFS model summary </span></span>
<span><span class="co">#&gt;   data:  569x30 </span></span>
<span><span class="co">#&gt;   labels:  B: 357 M: 212 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === constraints === </span></span>
<span><span class="co">#&gt;   - - - - - - - - - -  group  1   - - - - - - - - - - </span></span>
<span><span class="co">#&gt;  constraint 1: (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) x &lt;= 3; rho = 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === prior weights === </span></span>
<span><span class="co">#&gt;   weights: ( 0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01 ) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === likelihood === </span></span>
<span><span class="co">#&gt;   ensemble counts: ( 0,14,79,0,0,0,100,100,0,0,0,0,3,100,0,0,5,0,0,0,100,85,100,100,3,11,100,100,0,0 ) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === feature selection results === </span></span>
<span><span class="co">#&gt;  no output produced yet</span></span></code></pre></div>
<p>The prior constraints are shown as a linear inequation system
together with the penalty term <span class="math inline">\(\rho\)</span>. Further, the current prior weight
and the ensemble feature counts (likelihood) for each feature are
printed. As the model is not trained yet, the final feature selection
result is empty.</p>
<p>In addition to <code>mRMR</code>, we add a function
<code>decision_tree()</code> that computes features based on decision
tree importances.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart" class="external-link">rpart</a></span><span class="op">)</span></span>
<span><span class="va">decision_tree</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">n</span>, <span class="va">name</span> <span class="op">=</span> <span class="st">"tree"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rf_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rf_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rf_data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">tree</span> <span class="op">=</span> <span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">rf_data</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranks<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">variable.importance</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            name <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/build.UBaymodel.html">build.UBaymodel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bcw</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                        target <span class="op">=</span> <span class="va">bcw</span><span class="op">$</span><span class="va">labels</span>,</span>
<span>                        M <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                        tt_split <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                        nr_features <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mRMR"</span>, <span class="va">decision_tree</span><span class="op">)</span>,</span>
<span>                        prior_model <span class="op">=</span><span class="st">"dirichlet"</span>,</span>
<span>                        weights <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                        lambda <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        constraints <span class="op">=</span> <span class="fu"><a href="../reference/buildConstraints.html">buildConstraints</a></span><span class="op">(</span>constraint_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max_size"</span><span class="op">)</span>, </span>
<span>                                                       constraint_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>                                                       num_elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bcw</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                                                       rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        optim_method <span class="op">=</span> <span class="st">"GA"</span>,</span>
<span>                        popsize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                        maxiter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                        shiny <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                        <span class="op">)</span></span></code></pre></div>
<p>Examples for more feature selection methods are:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># recursive feature elimination</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="va">rec_fe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">y</span>,<span class="va">n</span>, <span class="va">name</span><span class="op">=</span><span class="st">"rfe"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/rfeControl.html" class="external-link">rfeControl</a></span><span class="op">(</span>functions<span class="op">=</span><span class="va">rfFuncs</span>, method <span class="op">=</span> <span class="st">"cv"</span>, number <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span><span class="op">{</span></span>
<span>        <span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/rfeControl.html" class="external-link">rfeControl</a></span><span class="op">(</span>functions<span class="op">=</span><span class="va">lmFuncs</span>, method <span class="op">=</span> <span class="st">"cv"</span>, number <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/rfe.html" class="external-link">rfe</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, sizes <span class="op">=</span> <span class="va">n</span>, rfeControl<span class="op">=</span><span class="va">control</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">results</span><span class="op">$</span><span class="va">optVariables</span><span class="op">)</span>,</span>
<span>                  name <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Lasso</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="va">lasso</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">n</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">name</span><span class="op">=</span><span class="st">"lasso"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">family</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="st">"binomial"</span>, <span class="st">"gaussian"</span><span class="op">)</span></span>
<span>  <span class="va">cv.lasso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="va">y</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">family</span>, nfolds<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="va">y</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">family</span>,</span>
<span>                  lambda <span class="op">=</span> <span class="va">cv.lasso</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>              name <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># HSIC Lasso</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GSelection</span><span class="op">)</span></span>
<span><span class="va">hsic_lasso</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">n</span>, <span class="va">name</span><span class="op">=</span><span class="st">"hsic"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="op">{</span><span class="va">tl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>, <span class="op">{</span><span class="va">tl</span> <span class="op">=</span> <span class="va">y</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GSelection/man/feature.selection.html" class="external-link">feature.selection</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">tl</span>, <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ranks <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">hsic_selected_feature_index</span>,</span>
<span>              name <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="user-knowledge">User knowledge<a class="anchor" aria-label="anchor" href="#user-knowledge"></a>
</h3>
<p>Using the function <code><a href="../reference/setWeights.html">setWeights()</a></code> the user is able to
change the feature weights from the standard initialization to desired
values. In our example, we assign equal weights to features originating
from the same image characteristic. Weights can be on an arbitrary
scale. As it is difficult to specify prior weights in real-life
applications, we suggest to define them on a normalized scale.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">16</span>,<span class="fl">15</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">17</span>,<span class="fl">21</span>,<span class="fl">14</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">strength</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">weights</span> <span class="op">=</span> <span class="va">weights</span> <span class="op">*</span> <span class="va">strength</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0.02222222 0.03333333 0.04444444 0.03555556 0.03333333 0.02222222</span></span>
<span><span class="co">#&gt;  [7] 0.02666667 0.03777778 0.04666667 0.03111111 0.02222222 0.03333333</span></span>
<span><span class="co">#&gt; [13] 0.04444444 0.03555556 0.03333333 0.02222222 0.02666667 0.03777778</span></span>
<span><span class="co">#&gt; [19] 0.04666667 0.03111111 0.02222222 0.03333333 0.04444444 0.03555556</span></span>
<span><span class="co">#&gt; [25] 0.03333333 0.02222222 0.02666667 0.03777778 0.04666667 0.03111111</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/setWeights.html">setWeights</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, </span>
<span>                   weights <span class="op">=</span> <span class="va">weights</span><span class="op">)</span></span></code></pre></div>
<p>Feature constraints can be defined using the function
<code><a href="../reference/buildConstraints.html">buildConstraints()</a></code>. The input <code>constraint_types</code>
consists of a vector, where all constraint types are defined. Then, with
<code>constraint_vars</code>, the user specifies details about the
constraint: for max-size, the number of features to select is provided,
while for must-link and cannot-link, the set of feature indices to be
linked must be provided. Each list entry corresponds to one constraint
in <code>constraint_types</code>. In addition, <code>num_features</code>
denotes the total number of features in the dataset (or the total number
of blocks if the constraint is block-wise) and <code>rho</code>
corresponds to the relaxation parameter of the admissibility function.
For block constraints, information about the block structure is included
either with <code>block_list</code>or <code>block_matrix</code>.</p>
<p>Applying <code>print(constraints)</code> demonstrates that, the
matrix <code>A</code> has ten rows to represent four constraints. While
<em>max-size</em> and <em>cannot-link</em> can be expressed in one
equation each, <em>must-link</em> is a pairwise constraint. In specific,
the <em>must-link</em> constraint between <span class="math inline">\(n\)</span> features produces <span class="math inline">\(\frac{n!}{(n-2)!}\)</span> elementary constraints.
Hence, six equations represent the <em>must-link</em> constraint. The
function <code><a href="../reference/setConstraints.html">setConstraints()</a></code> integrates the constraints into
the UBayFS model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">constraints</span> <span class="op">=</span> <span class="fu"><a href="../reference/buildConstraints.html">buildConstraints</a></span><span class="op">(</span>constraint_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max_size"</span>, </span>
<span>                                                    <span class="st">"must_link"</span>, </span>
<span>                                                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"cannot_link"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               constraint_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">10</span>, <span class="co"># max-size (maximal 10 features)</span></span>
<span>                                                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">11</span>,<span class="fl">21</span><span class="op">)</span>, <span class="co"># must-link between features 1, 11, and 21</span></span>
<span>                                                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, <span class="co"># cannot-link between features 1, and 10</span></span>
<span>                                                      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">23</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span>, <span class="co"># cannot-link between features 20, 23, and 24</span></span>
<span>                               num_elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>,</span>
<span>                                rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="co"># max_size</span></span>
<span>                                        <span class="fl">0.1</span>, <span class="co"># rho for must-link</span></span>
<span>                                        <span class="fl">1</span>, <span class="co"># rho for first cannot-link</span></span>
<span>                                        <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># rho for second cannot-link</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">constraints</span><span class="op">)</span></span>
<span><span class="co">#&gt; $A</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span></span>
<span><span class="co">#&gt;  [1,]    1    1    1    1    1    1    1    1    1     1     1     1     1</span></span>
<span><span class="co">#&gt;  [2,]   -1    0    0    0    0    0    0    0    0     0     1     0     0</span></span>
<span><span class="co">#&gt;  [3,]   -1    0    0    0    0    0    0    0    0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [4,]    1    0    0    0    0    0    0    0    0     0    -1     0     0</span></span>
<span><span class="co">#&gt;  [5,]    0    0    0    0    0    0    0    0    0     0    -1     0     0</span></span>
<span><span class="co">#&gt;  [6,]    1    0    0    0    0    0    0    0    0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [7,]    0    0    0    0    0    0    0    0    0     0     1     0     0</span></span>
<span><span class="co">#&gt;  [8,]    1    0    0    0    0    0    0    0    0     1     0     0     0</span></span>
<span><span class="co">#&gt;  [9,]    0    0    0    0    0    0    0    0    0     0     0     0     0</span></span>
<span><span class="co">#&gt;       [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]</span></span>
<span><span class="co">#&gt;  [1,]     1     1     1     1     1     1     1     1     1     1     1     1</span></span>
<span><span class="co">#&gt;  [2,]     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [3,]     0     0     0     0     0     0     0     1     0     0     0     0</span></span>
<span><span class="co">#&gt;  [4,]     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [5,]     0     0     0     0     0     0     0     1     0     0     0     0</span></span>
<span><span class="co">#&gt;  [6,]     0     0     0     0     0     0     0    -1     0     0     0     0</span></span>
<span><span class="co">#&gt;  [7,]     0     0     0     0     0     0     0    -1     0     0     0     0</span></span>
<span><span class="co">#&gt;  [8,]     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [9,]     0     0     0     0     0     0     1     0     0     1     1     0</span></span>
<span><span class="co">#&gt;       [,26] [,27] [,28] [,29] [,30]</span></span>
<span><span class="co">#&gt;  [1,]     1     1     1     1     1</span></span>
<span><span class="co">#&gt;  [2,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [3,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [4,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [5,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [6,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [7,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [8,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [9,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $b</span></span>
<span><span class="co">#&gt; [1] 10  0  0  0  0  0  0  1  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rho</span></span>
<span><span class="co">#&gt; [1] Inf 0.1 0.1 0.1 0.1 0.1 0.1 1.0 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $block_matrix</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/setConstraints.html">setConstraints</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, constraints <span class="op">=</span> <span class="va">constraints</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optimization-and-evaluation">Optimization and evaluation<a class="anchor" aria-label="anchor" href="#optimization-and-evaluation"></a>
</h3>
<p>A genetic algorithm, described by <span class="citation">(Givens and
Hoeting 2012)</span> and implemented in <span class="citation">(Scrucca
2013)</span>, searches for the optimal feature set in the UBayFS
framework. Using <code><a href="../reference/setOptim.html">setOptim()</a></code> we initialize the genetic
algorithm. Furthermore, <code>popsize</code> indicates the number of
candidate feature sets created in each iteration, and
<code>maxiter</code> is the number of iterations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/setOptim.html">setOptim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                 popsize <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                 maxiter <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p>At this point, we have initialized prior weights, constraints, and
the optimization procedure — we can now train the UBayFS model using the
generic function <code><a href="../reference/train.html">train()</a></code>, relying on a genetic algorithm.
The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function provides an overview of all
components of UBayFS. The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function shows the prior
feature information as bar charts, with the selected features marked
with red borders. In addition, the constraints and the regularization
parameter <span class="math inline">\(\rho\)</span> are presented.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">=</span> <span class="fu">UBayFS</span><span class="fu">::</span><span class="fu"><a href="../reference/train.html">train</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running Genetic Algorithm</span></span>
<span><span class="co">#&gt; [1] "SAMPLING FINISHED"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt;  UBayFS model summary </span></span>
<span><span class="co">#&gt;   data:  569x30 </span></span>
<span><span class="co">#&gt;   labels:  B: 357 M: 212 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === constraints === </span></span>
<span><span class="co">#&gt;   - - - - - - - - - -  group  1   - - - - - - - - - - </span></span>
<span><span class="co">#&gt;  constraint 1: (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) x &lt;= 10; rho = Inf</span></span>
<span><span class="co">#&gt;  constraint 2: (-1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0) x &lt;= 0; rho = 0.1</span></span>
<span><span class="co">#&gt;  constraint 3: (-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0) x &lt;= 0; rho = 0.1</span></span>
<span><span class="co">#&gt;  constraint 4: (1,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0) x &lt;= 0; rho = 0.1</span></span>
<span><span class="co">#&gt;  constraint 5: (0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0) x &lt;= 0; rho = 0.1</span></span>
<span><span class="co">#&gt;  constraint 6: (1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0) x &lt;= 0; rho = 0.1</span></span>
<span><span class="co">#&gt;  constraint 7: (0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0) x &lt;= 0; rho = 0.1</span></span>
<span><span class="co">#&gt;  constraint 8: (1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0) x &lt;= 1; rho = 1</span></span>
<span><span class="co">#&gt;  constraint 9: (0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0) x &lt;= 1; rho = 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === prior weights === </span></span>
<span><span class="co">#&gt;   weights: ( 0.0222222222222222,0.0333333333333333,0.0444444444444444,0.0355555555555556,0.0333333333333333,0.0222222222222222,0.0266666666666667,0.0377777777777778,0.0466666666666667,0.0311111111111111,0.0222222222222222,0.0333333333333333,0.0444444444444444,0.0355555555555556,0.0333333333333333,0.0222222222222222,0.0266666666666667,0.0377777777777778,0.0466666666666667,0.0311111111111111,0.0222222222222222,0.0333333333333333,0.0444444444444444,0.0355555555555556,0.0333333333333333,0.0222222222222222,0.0266666666666667,0.0377777777777778,0.0466666666666667,0.0311111111111111 ) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === likelihood === </span></span>
<span><span class="co">#&gt;   ensemble counts: ( 0,14,79,0,0,0,100,100,0,0,0,0,3,100,0,0,5,0,0,0,100,85,100,100,3,11,100,100,0,0 ) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   === feature selection results === </span></span>
<span><span class="co">#&gt;   ( 2,3,7,8,14,22,23,26,27,28 )</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><img src="UBayFS_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;">
After training the model, we receive a feature selection result. More
than one optimal feature set with the same MAP score is possible. The
plot shows the selected features (red framed) and their selection
distribution between ensemble feature selection and prior weights. The
constraints are shown at the top, where a connecting line is drawn
between features of one constraint. The final feature set and its
additional properties can be evaluated with
<code><a href="../reference/evaluateFS.html">evaluateFS()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># evaluation feature set</span></span>
<span><span class="fu"><a href="../reference/evaluateFS.html">evaluateMultiple</a></span><span class="op">(</span>state <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">feature_set</span>, model <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                  [,1]</span></span>
<span><span class="co">#&gt; cardinality                    10.000</span></span>
<span><span class="co">#&gt; log total utility              -0.238</span></span>
<span><span class="co">#&gt; log posterior feature utility  -0.238</span></span>
<span><span class="co">#&gt; log admissibility               0.000</span></span>
<span><span class="co">#&gt; number of violated constraints  0.000</span></span>
<span><span class="co">#&gt; avg feature correlation         0.614</span></span></code></pre></div>
<p>The output contains the following information:</p>
<ul>
<li>
<strong>cardinality</strong>: number of selected features</li>
<li>
<strong>log total utility</strong>: value of the target function for
optimization</li>
<li>
<strong>log posterior feature utility</strong>: cumulated
importances of selected features before substracting a penalization
term</li>
<li>
<strong>log admissibility</strong>: if 0, all constraints are
fulfilled, otherwise at least one constraint is violated</li>
<li>
<strong>number violated constraints</strong>: number of violated
constraints</li>
<li>
<strong>avg feature correlation</strong>: average correlation
between features in dataset</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="shiny-dashboard">Shiny dashboard<a class="anchor" aria-label="anchor" href="#shiny-dashboard"></a>
</h2>
<p><code>UBayFS</code> provides an interactive <code>R Shiny</code>
dashboard as GUI. With its intuitive user interface, the user can load
data, set likelihood parameters, and even control the admissibility
regularization strength of each constraint. With the command
<code><a href="../reference/runInteractive.html">runInteractive()</a></code>, the Shiny dashboard opens, given that the
required depedencies are available (see above). Histograms and plots
help to get an overview of the user’s settings. The interactive
dashboard offers <code>save</code> and <code>load</code> buttons to save
or load UBayFS models as RData files. Due to computational limitations,
it is not recommended to use the HTML interface for larger datasets
(<span class="math inline">\(&gt; 100\)</span> features or <span class="math inline">\(&gt;1000\)</span> samples).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runInteractive.html">runInteractive</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="UBay_Shiny_Screenshot.png" width="100%" style="display: block; margin: auto;"></p>
<p>The dashboard includes multiple tabs:</p>
<ul>
<li>
<strong>data</strong>: Load the dataset and specify whether row
names, column names or a block structure is present. A demo dataset is
ready to be loaded and used for a first touch on the package.</li>
<li>
<strong>likelihood</strong>: Select elementary feature selectors for
ensemble feature selection, the number of models <span class="math inline">\(M\)</span>, the number of features in each model,
and the ratio of the train-test split. Further, the dashboard allows the
user to mix different elementary feature selectors, although this option
is not recommended due to limited stability <span class="citation">(Seijo-Pardo et al. 2017)</span>.</li>
<li>
<strong>weights</strong>: The prior feature weights are set by the
user. For block feature selection, it is possible to set weights for
blocks; otherwise, for a single feature.</li>
<li>
<strong>constraints / block constraints</strong>: In this task, the
user sets different constraints (at least a max-size constraint). The
penalty <span class="math inline">\(\rho\)</span> can be varied here as
well.</li>
<li>
<strong>feature selection</strong>: In the dashboard’s last step, an
optimization procedure determines the final feature set. A plot of the
final result is produced - also, the model can be saved as an Rdata file
and loaded to the dashboard again.</li>
</ul>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>With the methodology in place, UBayFS is applicable to a large range
of feature selection problems with multiple sources of information. The
likelihood parameters, steering the number of elementary models, mainly
affect the stability and runtime of the result — the latter linearly
increases with the number of models. Especially the Shiny dashboard
delivers insight into the single UBayFS steps. Nevertheless, the
dashboard only applies to smaller datasets, while larger ones should be
computed in the console.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-givens:compstat" class="csl-entry">
Givens, G. H., and J. A. Hoeting. 2012. <em>Computational
Statistics</em>. Vol. 703. John Wiley &amp; Sons.
</div>
<div id="ref-hankin:hyperdirichlet" class="csl-entry">
Hankin, Robin K. S. 2010. <span>“<span class="nocase">A Generalization
of the Dirichlet Distribution</span>.”</span> <em><span>Journal of
Statistical Software</span></em> 33 (11): 1–18.
</div>
<div id="ref-jenul2022ubayfs" class="csl-entry">
Jenul, Anna, Stefan Schrunner, Jürgen Pilz, and Oliver Tomic. 2022.
<span>“A User-Guided Bayesian Framework for Ensemble Feature Selection
in Life Science Applications (UBayFS).”</span> <em>Machine
Learning</em>, 1–27.
</div>
<div id="ref-R:DirichletReg" class="csl-entry">
Maier, M. J. 2020. <em>DirichletReg: Dirichlet Regression in r</em>. <a href="http://dirichletreg.r-forge.r-project.org/" class="external-link">http://dirichletreg.r-forge.r-project.org/</a>.
</div>
<div id="ref-R:GA" class="csl-entry">
Scrucca, L. 2013. <span>“<span>GA</span>: A Package for Genetic
Algorithms in <span>R</span>.”</span> <em>Journal of Statistical
Software</em> 53 (4): 1–37. <a href="http://www.jstatsoft.org/v53/i04/" class="external-link">http://www.jstatsoft.org/v53/i04/</a>.
</div>
<div id="ref-seijo:ensembleSurvey" class="csl-entry">
Seijo-Pardo, B., I. Porto-Díaz, V. Bolón-Canedo, and A. Alonso-Betanzos.
2017. <span>“Ensemble Feature Selection: Homogeneous and Heterogeneous
Approaches.”</span> <em>Knowledge-Based Systems</em> 118: 124–39.
https://doi.org/<a href="https://doi.org/10.1016/j.knosys.2016.11.017" class="external-link">https://doi.org/10.1016/j.knosys.2016.11.017</a>.
</div>
<div id="ref-wolberg:wisconsin" class="csl-entry">
Wolberg, W. H., and O. L. Mangasarian. 1990. <span>“Multisurface Method
of Pattern Separation for Medical Diagnosis Applied to Breast
Cytology.”</span> <em>Proceedings of the National Academy of
Sciences</em> 87 (23): 9193–96.
</div>
<div id="ref-wong:gdirichlet" class="csl-entry">
Wong, Tzu-Tsung. 1998. <span>“<span class="nocase">Generalized Dirichlet
distribution in Bayesian analysis</span>.”</span> <em><span>Applied
Mathematics and Computation</span></em> 97 (2): 165–81.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Anna Jenul, Stefan Schrunner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
